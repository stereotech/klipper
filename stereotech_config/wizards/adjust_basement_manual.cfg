[wizard ADJUST_BASEMENT_MANUAL]
image: wizards/zero_point_setup/zero_point_setup01.jpg
type: 5d
steps: ADJUST_BASEMENT_MANUAL0, CLEAR_NOZZLE0, CLEAR_NOZZLE1, ADJUST_BASEMENT_MANUAL1, ADJUST_BASEMENT_MANUAL2, ADJUST_BASEMENT_MANUAL3, ADJUST_BASEMENT_MANUAL4, ADJUST_BASEMENT_MANUAL5, ADJUST_BASEMENT_MANUAL6
variable_mode: ''
variable_wcs: 0
variable_continue_from_step: ''
variable_diameter: 6.0

[wizard_step_button ADJUST_BASEMENT_MANUAL0]
image: wizards/zero_point_setup/zero_point_setup.jpg
description: This wizard helps you to setup zero point for proper 5D printing
landscape: false
warning: none
countdown: 0
action_gcode:
    SET_WIZARD_ENABLE WIZARD={wizard.name} ENABLE=1 ERROR=''
    MOVE_SERVICE_POSITION
    SET_WIZARD_STEP WIZARD={wizard.name} STEP=ADJUST_BASEMENT_MANUAL1
button_clear_noozle_gcode:
    {% set extruder = printer.toolhead.extruder|default('extruder') %}
    SET_WIZARD_ENABLE WIZARD={wizard.name} ENABLE=1 ERROR=''
    MOVE_SERVICE_POSITION_HEAD
    SET_WIZARD_VARIABLE WIZARD={wizard.name} VARIABLE=continue_from_step VALUE=ADJUST_BASEMENT_MANUAL1
    CHANGE_STEP_AND_WAIT_HEATING WIZARD={wizard.name} STEP=CLEAR_NOZZLE0 TEMP=200 EXTRUDER={extruder}
cancel_gcode:
    RESET_WIZARD WIZARD={wizard.name}

[wizard_step_slider ADJUST_BASEMENT_MANUAL1]
image: wizards/zero_point_setup/zero_point_setup02.jpg
description: Set basement diameter and press Next
landscape: false
warning: none
countdown: 0
slider_set_diameter_min: 3
slider_set_diameter_max: 200
slider_set_diameter_step: 0.1
slider_set_diameter_default: 6
action_gcode:
    {% set diameter = printer["wizard_step_slider " ~ wizard.wizard_step_name].set_diameter|float %}
    SET_WIZARD_VARIABLE WIZARD={wizard.name} VARIABLE=diameter VALUE={diameter}
    SET_WIZARD_STEP WIZARD={wizard.name} STEP=ADJUST_BASEMENT_MANUAL2
cancel_gcode:
    RESET_WIZARD WIZARD={wizard.name}

[wizard_step ADJUST_BASEMENT_MANUAL2]
image: wizards/zero_point_setup/zero_point_setup04.jpg
description: Please place needed base in the 5D Module and press Next
landscape: false
warning: none
countdown: 0
action_gcode:
    SET_WIZARD_STEP WIZARD={wizard.name} STEP=ADJUST_BASEMENT_MANUAL3
cancel_gcode:
    RESET_WIZARD WIZARD={wizard.name}

[wizard_step_selector ADJUST_BASEMENT_MANUAL3]
image: wizards/zero_point_setup/zero_point_setup.jpg
description: Please select Printing mode which you want to use
landscape: false
warning: none
countdown: 0
items: 5D_spiral, 5D_spiral_full
placeholder: wizard-step-probe
action_gcode:
    {% set mode = printer['wizard ' ~ wizard.name].variables.mode %}
    {% set wcs = 2 if mode == '5D_spiral' else 1 %}
    SET_WIZARD_VARIABLE WIZARD={wizard.name} VARIABLE=wcs VALUE={wcs}
    MOVE_WCS_ZERO WCS={wcs}
    SET_WIZARD_STEP WIZARD={wizard.name} STEP={'ADJUST_BASEMENT_MANUAL' ~ (3 + wcs)}
cancel_gcode:
    RESET_WIZARD WIZARD={wizard.name}
select_gcode:
    SET_WIZARD_VARIABLE WIZARD={wizard.name} VARIABLE=mode VALUE={selected}

[wizard_step_jog ADJUST_BASEMENT_MANUAL4]
image: wizards/zero_point_setup/zero_point_setup01.jpg
description: Move nozzle to the center of the base and press Next
landscape: false
warning: none
countdown: 0
axes: x, y, z
steps: 0.05, 0.1, 1, 10
default_step: 1
jog_gcode:
    JOG_DO_MOVE {rawparams} STEP_NAME={wizard.wizard_step_name}
action_gcode:
    SET_WCS_OFFSET WCS=1 ADJUST_WCS=2 X=0 Y=0 Z=0
    SET_WIZARD_STEP WIZARD={wizard.name} STEP=ADJUST_BASEMENT_MANUAL6
cancel_gcode:
    RESET_WIZARD WIZARD={wizard.name}

[wizard_step_jog ADJUST_BASEMENT_MANUAL5]
image: wizards/zero_point_setup/zero_point_setup02.jpg
description: Move nozzle to the center of the base and press Next
landscape: false
warning: none
countdown: 0
axes: x, y, z
steps: 0.05, 0.1, 1, 10
default_step: 1
jog_gcode:
    JOG_DO_MOVE {rawparams} STEP_NAME={wizard.wizard_step_name}
action_gcode:
    {% set diameter = printer['wizard ' ~ wizard.name].variables.diameter|float %}
    SET_WCS_OFFSET WCS=2 ADJUST_WCS=1 X=0 Y=0 Z={diameter / 2.0}
    SET_WIZARD_STEP WIZARD={wizard.name} STEP=ADJUST_BASEMENT_MANUAL6
cancel_gcode:
    RESET_WIZARD WIZARD={wizard.name}

[wizard_step ADJUST_BASEMENT_MANUAL6]
image: wizards/zero_point_setup/zero_point_setup.jpg
description: Adjust basement completed
landscape: false
warning: none
countdown: 0
info: none
action_gcode:
    RESET_WIZARD WIZARD={wizard.name} ABORT=0
cancel_gcode:
    RESET_WIZARD WIZARD={wizard.name}
