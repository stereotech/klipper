[homing_override]
axes:
gcode:
    {% set axis_max = printer.toolhead.axis_maximum %}
    G28 Z
    G1 Z{axis_max[2] - 50} F3600
    G28 X
    G28 Y
    {% if printer["gcode_button five_axis_module"].state == "PRESSED" %}
        G28 A
        G28 C
    {% endif %}

[gcode_macro MOVE_SERVICE_POSITION]
gcode:
    G54
    TURN_OFF_HEATERS
    G28
    G92 E0
    {% set max_x = printer.toolhead.axis_maximum[0] %}
    G1 Z200 F3600
    G0 X{max_x / 2.0} Y50 F3600
    SET_IDLE_TIMEOUT TIMEOUT=7200

[gcode_macro MOVE_SERVICE_POSITION_HEAD]
gcode:
    {% set max_x = printer.toolhead.axis_maximum[0] %}
    G54
    TURN_OFF_HEATERS
    G28
    G92 E0
    G90
    G0 X{max_x / 2.0} Y50 Z200 F3600
    SET_IDLE_TIMEOUT TIMEOUT=7200

[gcode_macro HOME_POSITION]
gcode:
    {% set axis_max = printer.toolhead.axis_maximum %}
    G54
    TURN_OFF_HEATERS
    G1 C0
    G1 Z{axis_max[2] - 50}
    G1 Y0
    G28
    G92 E0
    G90
    {% if params.ABORT|default(0)|float == 0 %}
        SAVE_VARIABLES
        SAVE_STATE_MODULE
    {% else %}
        ABORT
    {% endif %}
    {% if printer.probe %}
        CANCEL_TEST_PROBE
    {% endif %}
    SET_IDLE_TIMEOUT TIMEOUT=600
